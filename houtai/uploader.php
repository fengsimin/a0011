<?php
//Copyright (c) 2016 iFeiwu.com
 class Uploader extends Ifeiwu { function __construct() { } protected function postImage($request_data) { goto PZUws; KQTtP: JYPfF: goto axpf8; JZh8V: return $this->error($handle->log); goto kMcdH; PZUws: $_FILES["\x66\x69\154\x65"]["\156\x61\x6d\x65"] = $_POST["\146\151\154\145\x5f\156\141\x6d\145"]; goto i7EVO; pReUB: $_FILES["\146\151\154\x65"]["\x73\151\172\145"] = $_POST["\x66\151\154\x65\137\x73\151\x7a\x65"]; goto EZk01; KPDx3: if ($handle->processed) { goto P3R3a; } goto JZh8V; S92Es: if (!$file_new_name_body) { goto LQWpw; } goto VqyzA; NogKi: sQL0k: goto KPDx3; cG0Nb: TbSoT: goto b_C_k; b1JmQ: E1KZZ: goto S92Es; lf3py: $handle = new Upload($_FILES["\x66\151\154\145"]); goto VEl3G; zfvqk: $handle->Process($upload_root . "\x2f" . $file_save_path); goto PLUkt; IAL7Q: $file_save_path = ''; goto A0Lsz; EZk01: $_FILES["\x66\151\x6c\145"]["\145\x72\x72\x6f\162"] = $_POST["\x66\x69\x6c\x65\137\145\162\x72\x6f\x72"]; goto VzUKt; QuQuD: $jpeg_quality = explode("\54", $_POST["\152\160\x65\147\x5f\161\x75\x61\x6c\x69\164\x79"]); goto UOUu0; LXa1k: goto pTNwt; goto KQTtP; N33Pk: $handle->image_convert = $image_convert; goto b1JmQ; JoQGe: $image_resize = $_POST["\x69\x6d\141\147\x65\x5f\162\145\x73\x69\x7a\x65"]; goto Z2ITM; oWYw3: if (!$image_convert) { goto E1KZZ; } goto N33Pk; VEl3G: if (!$handle->uploaded) { goto sQL0k; } goto Y55EI; djhBc: akPE4: goto NogKi; Jo9Ex: $image_y = explode("\x2c", $_POST["\x69\x6d\141\x67\x65\137\x79"]); goto C8LP6; rT17m: m07nE: goto Od2bf; UOUu0: if ($image_resize == 1) { goto TbSoT; } goto Au33E; QoqIk: if (!$quality) { goto TlbY_; } goto ejUeI; Zd202: P3R3a: goto wYmLc; Mf_Nl: $handle->file_overwrite = $file_overwrite ? true : false; goto zfvqk; iA_ih: $file_overwrite = $_POST["\x66\151\x6c\145\137\157\x76\145\162\167\162\151\164\145"]; goto JoQGe; muMAP: TlbY_: goto oWYw3; b_C_k: $file_name_body_pre = explode("\54", $_POST["\x66\151\154\x65\137\x6e\x61\x6d\145\x5f\142\x6f\x64\x79\x5f\x70\x72\145"]); goto wdXQ9; Y55EI: $upload_root = "\56\x2e\x2f"; goto cAPd4; e5sc_: return $this->success('', array("\160\x61\164\x68" => $file_save_path, "\151\x6d\141\147\145" => $handle->file_dst_name, "\163\x69\x7a\x65" => $handle->file_src_size, "\167\x69\x64\x74\x68" => $handle->image_src_x, "\x68\x65\151\x67\x68\164" => $handle->image_src_y, "\x74\x79\x70\145" => $handle->image_dst_type, "\145\x78\164" => $handle->file_dst_name_ext)); goto rT17m; C8LP6: foreach ($file_name_body_pre as $key => $prefix) { goto wxPKX; e2tre: EFnNl: goto jTIWn; rWWNP: $handle->image_x = $width; goto NYoHA; JmpjC: goto OoxVA; goto fu0QC; L_h79: if ($width && $handle->image_src_x > $width) { goto rD5ag; } goto dhuER; hEqCQ: if (!$prefix) { goto Vm10M; } goto IsexR; OllGP: $handle->image_convert = $image_convert; goto OJhVk; TLCGF: k_dQo: goto nn0tV; IsexR: $handle->image_resize = $image_resize ? true : false; goto dpV1t; zmHyU: vokzU: goto zZtIk; b17XR: becFp: goto aJVC2; zZtIk: if (!$file_new_name_body) { goto EFnNl; } goto gd5ZZ; o15p3: $handle->jpeg_quality = $quality; goto jr2hv; CMdA0: $handle->image_ratio_y = true; goto oRdn4; OJhVk: gnIlo: goto L_h79; jTIWn: $handle->file_overwrite = $file_overwrite ? true : false; goto BSIqy; BSIqy: $handle->Process($upload_root . "\57" . $file_save_path); goto TLCGF; jr2hv: fimt_: goto a5ShV; oRdn4: goto vokzU; goto b17XR; gd5ZZ: $handle->file_new_name_body = $file_new_name_body; goto e2tre; a5ShV: if (!$image_convert) { goto gnIlo; } goto OllGP; aJVC2: $handle->image_y = $height; goto zmHyU; wSL1J: if ($height && $handle->image_src_y > $height) { goto becFp; } goto CMdA0; zpoe9: $height = $image_y[$key]; goto RaUYk; dhuER: $handle->image_x = $handle->image_src_x; goto JmpjC; RaUYk: $quality = $jpeg_quality[$key]; goto hEqCQ; TmWl2: if (!$quality) { goto fimt_; } goto o15p3; NYoHA: OoxVA: goto wSL1J; dpV1t: $handle->file_name_body_pre = $prefix; goto btE18; btE18: Vm10M: goto TmWl2; fu0QC: rD5ag: goto rWWNP; wxPKX: $width = $image_x[$key]; goto zpoe9; nn0tV: } goto PoqNK; ejUeI: $handle->jpeg_quality = $quality; goto muMAP; cAPd4: $file_new_name_body = $_POST["\146\x69\154\145\137\156\x65\x77\x5f\x6e\141\155\x65\137\x62\x6f\144\171"]; goto iA_ih; wYmLc: if (!($file_save_path == "\57")) { goto zL52p; } goto IAL7Q; PLUkt: goto akPE4; goto cG0Nb; axpf8: ifeiwu\Loader::import("\145\170\x74\x65\x6e\144\x2f\x55\160\154\157\x61\144"); goto lf3py; Sb0Ob: LQWpw: goto Mf_Nl; NG85d: $image_convert = $_POST["\151\155\141\x67\145\137\x63\157\x6e\x76\x65\x72\x74"]; goto QuQuD; gImE7: return $this->error("\xe6\x97\240\346\x95\x88\347\232\x84\xe6\226\x87\344\xbb\266\xe4\277\241\346\x81\xaf\xef\274\x81"); goto LXa1k; VqyzA: $handle->file_new_name_body = $file_new_name_body; goto Sb0Ob; A0Lsz: zL52p: goto e5sc_; PoqNK: wp0gR: goto djhBc; Od2bf: pTNwt: goto qT5s5; wdXQ9: $image_x = explode("\x2c", $_POST["\x69\x6d\141\147\145\x5f\170"]); goto Jo9Ex; kMcdH: goto m07nE; goto Zd202; Au33E: $quality = end($jpeg_quality); goto QoqIk; i7EVO: $_FILES["\146\x69\154\145"]["\164\171\x70\145"] = $_POST["\146\151\154\145\137\x74\171\160\145"]; goto pReUB; VzUKt: if (!empty($_FILES["\146\151\x6c\x65"])) { goto JYPfF; } goto gImE7; Z2ITM: $file_save_path = $_POST["\146\x69\x6c\x65\x5f\x73\x61\x76\x65\x5f\x70\141\164\x68"]; goto NG85d; qT5s5: } protected function postFile($request_data) { goto tA0nC; iUGaW: if (!move_uploaded_file($file["\x74\155\x70\x5f\156\x61\155\145"], $dest_file)) { goto iOebi; } goto Xc9lv; bKOJj: lahp0: goto K9ReF; rLU8U: $_FILES["\146\x69\154\145"]["\x73\151\x7a\145"] = $_POST["\x66\151\154\145\137\163\151\172\145"]; goto f6ZbH; tZmw0: $resumableFilename = $this->_UTF82GBK($_POST["\162\145\163\165\155\141\x62\154\x65\x46\151\154\145\156\x61\155\145"]); goto BWxac; ytLFt: goto ER3F7; goto LLdMY; f6ZbH: $_FILES["\146\x69\154\x65"]["\x65\162\162\157\x72"] = $_POST["\146\x69\x6c\x65\137\145\162\x72\x6f\162"]; goto WIIs9; BWxac: $resumableChunkNumber = $_POST["\x72\145\163\165\x6d\141\x62\154\x65\103\x68\165\x6e\x6b\116\x75\x6d\x62\145\x72"]; goto RT5Yo; tcT0f: if (is_dir($temp_dir)) { goto fxs6A; } goto u3bvg; Xc9lv: $this->_createFileFromChunks($save_path, $temp_dir, $resumableFilename, $_POST["\162\x65\x73\165\155\141\x62\x6c\x65\103\150\165\156\x6b\123\x69\x7a\145"], $_POST["\162\x65\x73\x75\x6d\x61\142\154\145\x54\x6f\x74\141\154\x53\151\172\145"]); goto ytLFt; u3bvg: mkdir($temp_dir, 511, true); goto yA8G7; tA0nC: $save_path = "\x2e\56\x2f" . $this->_UTF82GBK($_POST["\163\141\166\145\137\x70\x61\x74\150"]); goto tZmw0; AyJEI: $dest_file = $temp_dir . "\x2f" . $resumableFilename . "\56\x70\x61\162\x74" . $resumableChunkNumber; goto tcT0f; r1SsP: ER3F7: goto geZlY; l3igi: $this->_debug("\x45\162\x72\x6f\x72\x20\163\x61\x76\151\156\147\40\50\155\157\x76\145\137\165\160\x6c\x6f\141\x64\x65\x64\x5f\146\x69\154\145\51\40\143\x68\165\156\153\x20" . $resumableChunkNumber . "\40\146\157\162\40\146\x69\x6c\145\40" . $resumableFilename); goto r1SsP; lURBW: $_FILES["\x66\151\x6c\145"]["\156\x61\x6d\145"] = $_POST["\x66\x69\x6c\x65\x5f\156\x61\155\145"]; goto jOWZU; kFFAI: if (!($file["\x65\162\162\157\x72"] != 0)) { goto lahp0; } goto ADW2t; K9ReF: $temp_dir = $save_path . "\x2f" . $resumableIdentifier; goto AyJEI; yA8G7: fxs6A: goto iUGaW; RT5Yo: $resumableIdentifier = $_POST["\x72\x65\x73\165\x6d\x61\x62\x6c\x65\x49\x64\145\x6e\x74\151\146\151\145\162"]; goto lURBW; ADW2t: $this->_debug("\x65\x72\x72\157\162\40" . $file["\145\162\x72\157\x72"] . "\x20\x69\x6e\x20\146\x69\154\x65\x20" . $resumableFilename); goto bKOJj; LLdMY: iOebi: goto l3igi; WIIs9: $file = $_FILES["\146\151\154\145"]; goto kFFAI; jOWZU: $_FILES["\146\x69\154\x65"]["\164\171\x70\145"] = $_POST["\146\151\154\x65\x5f\164\x79\160\x65"]; goto rLU8U; geZlY: } protected function getFile() { goto Duhpg; f4MJV: goto pWrzN; goto BOF9v; BOF9v: EdHCt: goto qmZne; QfVzH: pWrzN: goto KT3HA; etB2k: $resumableIdentifier = $_GET["\x72\x65\x73\x75\155\x61\x62\x6c\x65\111\x64\145\156\164\x69\146\151\x65\x72"]; goto ZBd_w; oDRJo: if (file_exists($chunk_file)) { goto EdHCt; } goto LeqRe; fJHNB: $resumableChunkNumber = $_GET["\x72\x65\163\165\x6d\x61\x62\x6c\145\x43\150\x75\x6e\153\x4e\x75\155\142\x65\x72"]; goto etB2k; dJoTJ: $resumableFilename = $this->_UTF82GBK($_GET["\x72\145\163\165\155\141\x62\x6c\x65\x46\x69\x6c\145\x6e\141\x6d\x65"]); goto fJHNB; qmZne: return 202; goto QfVzH; NAEv3: $chunk_file = $temp_dir . "\57" . $resumableFilename . "\56\x70\141\162\164" . $resumableChunkNumber; goto oDRJo; ZBd_w: $temp_dir = $save_path . "\x2f" . $resumableIdentifier; goto NAEv3; LeqRe: return 404; goto f4MJV; Duhpg: $save_path = "\x2e\x2e\x2f" . $this->_UTF82GBK($_GET["\x73\x61\166\145\x5f\160\x61\x74\x68"]); goto dJoTJ; KT3HA: } private function _createFileFromChunks($save_path, $temp_dir, $fileName, $chunkSize, $totalSize) { goto qaoSe; bV37S: if (rename($temp_dir, $temp_dir . "\x5f\x55\116\125\123\105\104")) { goto Zdp2_; } goto Xedpb; hIw3d: fwrite($fp, file_get_contents($temp_dir . "\57" . $fileName . "\56\x70\x61\162\164" . $i)); goto kYfN0; EH377: g1UGA: goto eg3Nl; nV0gF: goto Z2GSV; goto DwOLa; CpICp: if (($fp = fopen($save_path . "\57" . $fileName, "\167")) !== false) { goto t3Z7e; } goto pJQvQ; kYfN0: mDvEV: goto zO56G; lCCaV: oaLQS: goto bV37S; F9T1X: $this->_rrmdir($temp_dir . "\137\x55\116\x55\123\x45\104"); goto v2z0y; qAr3F: fclose($fp); goto lCCaV; vPO9k: DC05g: goto x_E92; eg3Nl: if (!($total_files * $chunkSize >= $totalSize - $chunkSize + 1)) { goto DC05g; } goto CpICp; w3w6y: $i = 1; goto xdzuq; zO56G: $i++; goto lPZRs; Xedpb: $this->_rrmdir($temp_dir); goto nV0gF; pJQvQ: $this->_debug("\143\x61\156\156\157\164\40\x63\x72\x65\141\x74\x65\x20\x74\x68\145\40\x64\x65\163\164\151\156\x61\x74\151\x6f\x6e\x20\x66\x69\154\x65"); goto gDV_N; xdzuq: ysq4F: goto e10Go; pd9eH: t3Z7e: goto w3w6y; gDV_N: return false; goto qFf81; DwOLa: Zdp2_: goto F9T1X; qFf81: goto oaLQS; goto pd9eH; v2z0y: Z2GSV: goto vPO9k; hDnlm: foreach (scandir($temp_dir) as $file) { goto y_6Oa; AcD0j: Q9D3R: goto zg03s; GHcGs: nMjth: goto AcD0j; y_6Oa: if (!(stripos($file, $fileName) !== false)) { goto nMjth; } goto Gztbf; Gztbf: $total_files++; goto GHcGs; zg03s: } goto EH377; qaoSe: $total_files = 0; goto hDnlm; JidNL: aYudD: goto qAr3F; lPZRs: goto ysq4F; goto JidNL; e10Go: if (!($i <= $total_files)) { goto aYudD; } goto hIw3d; x_E92: } private function _rrmdir($dir) { goto ZhEj2; D6eJM: b2mkJ: goto ZOEqf; cnqto: rmdir($dir); goto D6eJM; rUOxa: $objects = scandir($dir); goto WkpEo; Ndqmy: EHCXK: goto PZAjN; ZhEj2: if (!is_dir($dir)) { goto b2mkJ; } goto rUOxa; PZAjN: reset($objects); goto cnqto; WkpEo: foreach ($objects as $object) { goto llBR9; Ettzm: goto FfevB; goto jbvuf; DpTaJ: unlink($dir . "\57" . $object); goto Ettzm; sVLGH: hIfEc: goto xdITQ; BwWYG: if (filetype($dir . "\57" . $object) == "\x64\x69\x72") { goto gMTk8; } goto DpTaJ; MiOno: FfevB: goto Y0itj; llBR9: if (!($object != "\x2e" && $object != "\56\x2e")) { goto YnsPu; } goto BwWYG; jbvuf: gMTk8: goto bnscb; Y0itj: YnsPu: goto sVLGH; bnscb: $this->_rrmdir($dir . "\x2f" . $object); goto MiOno; xdITQ: } goto Ndqmy; ZOEqf: } }
