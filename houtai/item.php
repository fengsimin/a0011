<?php
//Copyright (c) 2016 iFeiwu.com
 class Item extends Ifeiwu { public function __construct() { goto SWy3p; SWy3p: if ($this->table) { goto y71AY; } goto ALBNX; OVnyu: y71AY: goto s3PRI; ALBNX: $this->table = "\x69\164\145\155"; goto OVnyu; s3PRI: parent::__construct(); goto QnmvX; QnmvX: } protected function postPage($request_data) { goto thXWm; TLHjT: $where = $request_data["\167\150\x65\162\x65"] ?: "\61\x20\75\40\61"; goto puQJH; JX2wF: $list = $this->db->select($this->table, $column)->where($where)->order($order)->limit(array($page * $perpage, $perpage))->all(); goto hIVtD; PIMzD: $total = $this->db->select($this->table)->where($where)->count(); goto JX2wF; jHMnP: YvDp9: goto m3zGx; q83G8: $page = $request_data["\160\141\147\145"] ?: 1; goto DxDJi; WTRUq: goto YvDp9; goto p7R_D; hIVtD: $data = array("\x6c\x69\163\164" => $list, "\164\157\x74\141\154" => $total, "\160\x65\162\160\141\x67\145" => $perpage, "\160\141\x67\145" => $page); goto jHMnP; puQJH: $order = $request_data["\157\x72\x64\x65\162"] ?: $this->order; goto Eqs_n; thXWm: $this->_callback("\x63\x61\x6c\154\142\x61\x63\x6b\x50\x61\x67\x65\102\145\x66\x6f\x72\145", array(&$request_data)); goto EbqA0; Eqs_n: $perpage = $request_data["\x70\x65\162\160\x61\147\x65"] ?: 0; goto WiwfJ; p7R_D: SIf5f: goto q83G8; aQr15: $data = $this->db->select($this->table, $column)->where($where)->order($order)->all(); goto WTRUq; DxDJi: $page = $page ? $page - 1 : 0; goto PIMzD; WiwfJ: if ($perpage > 0) { goto SIf5f; } goto aQr15; m3zGx: $this->_callback("\x63\x61\x6c\154\142\141\x63\x6b\120\141\147\145\101\x66\164\x65\x72", array(&$data)); goto fsgsg; EbqA0: $column = $request_data["\143\x6f\x6c\x75\155\x6e"] ?: "\x2a"; goto TLHjT; fsgsg: return $this->success($data); goto J7VXF; J7VXF: } protected function postQuery($request_data) { goto H4rDL; H4rDL: $sql = $request_data["\163\161\x6c"]; goto fqnIE; EUHmG: mUwML: goto cfSWg; cfSWg: return $this->db->query($sql, $request_data["\166\141\154\165\x65\163"])->all(); goto HSdrh; fqnIE: if (!(stripos($sql, "\44\x74\141\x62\x6c\x65") !== false)) { goto mUwML; } goto Oh9d8; Oh9d8: $sql = str_replace("\x24\x74\x61\142\x6c\145", $this->prefix . $this->table, $sql); goto EUHmG; HSdrh: } protected function getOne($id, $column = null) { goto dQLNR; cF9NO: $data = $this->db->select($this->table, $column)->where(array("\151\144", "\x3d", $id))->get(); goto Jc40J; Jc40J: return $this->success($data); goto nyaJh; dQLNR: $column = $column ?: "\52"; goto cF9NO; nyaJh: } protected function postAdd($request_data) { goto dt06s; HVi4M: $data = $this->_bulidData($request_data); goto wbQVU; wxRIQ: $this->db->beginTransaction(); goto MlQov; q1FvT: $this->db->rollBack(); goto fFFdI; wbQVU: $data["\143\x74\x69\x6d\x65"] = time(); goto wxRIQ; AHZfc: $upload_path = $this->_bulidUploadPath($upload_path, $data); goto MwCUJ; BNG0l: if ($this->db->update($this->table, $udata, array("\151\144", "\75", $id))->is()) { goto WyG1s; } goto q1FvT; p0Rap: if (!($pid > 0 && in_array("\154\145\166\x65\x6c", $this->fields))) { goto KxxTj; } goto CU4rV; nlYQw: aptZf: goto lVHyA; KQE4l: $upload_name = $request_data["\x24\x75\160\154\x6f\141\144\x5f\156\141\x6d\145"]; goto nFEVq; CU4rV: $udata["\154\145\166\145\154"] = $this->_getLevel($pid, $id); goto O_90W; ycHU7: if (!($upload_name && $upload_path)) { goto dmFeQ; } goto rcc81; a1Scg: $this->db->commit(); goto jrUqT; Gn5vB: MzLQ2: goto Uvbno; nFEVq: $upload_path = $request_data["\x24\165\x70\154\x6f\141\x64\x5f\160\x61\164\150"]; goto ycHU7; qAPXR: return $this->error("\346\xb7\xbb\345\212\xa0\xe6\225\260\346\215\256\345\xa4\261\350\xb4\xa5\xef\274\x81"); goto Gn5vB; MlQov: $id = $this->db->insert($this->table, $data)->id(); goto KlNW0; tgNJm: $this->_callback("\x63\x61\x6c\154\x62\141\x63\153\101\144\x64\101\146\164\145\162", array($id, &$request_data)); goto JUkME; jD_U3: $pid = $data["\x70\x69\144"]; goto p0Rap; rcc81: $data["\x69\144"] = $id; goto AHZfc; jrUqT: return $this->success("\xe6\267\273\345\212\240\xe6\x95\xb0\346\x8d\256\346\210\x90\xe5\x8a\x9f\xef\xbc\201", array("\x69\144" => $id, "\151\155\141\x67\x65\137\160\141\164\x68" => $upload_path)); goto nlYQw; K6Dl4: WyG1s: goto tgNJm; KlNW0: if ($id) { goto MzLQ2; } goto qAPXR; MwCUJ: $udata[$upload_name] = $upload_path; goto rvTgK; O_90W: KxxTj: goto KQE4l; JUkME: $this->_log("\x61\144\x64", array("\x74\x69\x74\x6c\x65" => $data["\x74\151\164\x6c\145"], "\x74\141\x62\154\145\x5f\x69\x64" => $id)); goto a1Scg; dt06s: $this->_callback("\143\141\x6c\154\142\141\x63\x6b\x41\x64\x64\102\145\146\157\162\x65", array(&$request_data)); goto Z2niE; Z2niE: $this->_removeFiles2($request_data["\x5f\162\x65\155\157\x76\145\x66\x69\154\145\163"]); goto HVi4M; bnLDE: goto aptZf; goto K6Dl4; fFFdI: return $this->error("\346\xb7\273\xe5\212\240\346\x95\xb0\xe6\215\xae\345\xa4\xb1\xe8\264\245\357\xbc\x81"); goto bnLDE; rvTgK: dmFeQ: goto BNG0l; Uvbno: $udata = array("\x69\144" => $id); goto jD_U3; lVHyA: } protected function postUpdate($id, $request_data) { goto a2kAE; HoB_s: $upload_path = $this->_bulidUploadPath($upload_path, $data); goto bvePB; I0OR9: jcTBa: goto SkHqW; dXMRC: qH5ab: goto QisMp; Pa4Dm: $data["\x75\x74\151\x6d\x65"] = time(); goto WrmFS; WrmFS: $pid = $data["\x70\x69\x64"]; goto fE5kG; mZpRM: wEUuc: goto A7X2n; A7X2n: YRwz_: goto a7z29; liGbu: $data = $this->_bulidData($request_data); goto Pa4Dm; a2kAE: $this->_callback("\x63\x61\x6c\x6c\142\141\143\x6b\125\160\144\x61\164\145\x42\145\x66\x6f\x72\x65", array(&$request_data)); goto KpFYA; SkHqW: $this->_callback("\143\141\154\154\x62\141\x63\x6b\x55\160\144\x61\x74\x65\101\146\164\145\x72", array($id, &$request_data)); goto BT1Va; zUpG4: $upload_name = $request_data["\x24\165\x70\154\x6f\141\x64\x5f\156\141\155\145"]; goto M1WEt; BT1Va: $this->_log("\x75\160\144\x61\x74\x65", array("\164\x69\x74\154\x65" => $data["\x74\151\164\154\145"])); goto yayBh; a7z29: if ($this->db->update($this->table, $data, array("\x69\144", "\x3d", $id))->is()) { goto jcTBa; } goto JJjaJ; M1WEt: $upload_path = $request_data["\x24\165\160\x6c\157\141\144\x5f\x70\141\164\x68"]; goto Bgv4c; sLkth: Q3rw_: goto zUpG4; fE5kG: if (!($pid > 0 && in_array("\154\x65\166\145\154", $this->fields))) { goto Q3rw_; } goto sYb_L; nGHOK: goto qH5ab; goto I0OR9; sYb_L: $data["\x6c\x65\x76\145\154"] = $this->_getLevel($pid, $id); goto sLkth; yayBh: return $this->success("\345\267\262\344\xbf\235\345\xad\230\346\233\264\xe6\x94\xb9\xef\274\201"); goto dXMRC; Bgv4c: if (!($upload_name && $upload_path)) { goto YRwz_; } goto HoB_s; JJjaJ: return $this->error("\344\277\x9d\xe5\xad\x98\xe5\244\261\350\xb4\xa5\xef\xbc\x81"); goto nGHOK; KpFYA: $this->_removeFiles2($request_data["\137\162\145\155\x6f\x76\x65\146\151\154\x65\x73"]); goto liGbu; bvePB: if (!in_array($upload_name, $this->fields)) { goto wEUuc; } goto HbLqO; HbLqO: $data[$upload_name] = $upload_path; goto mZpRM; QisMp: } protected function postField($request_data) { goto jNz73; XdTfN: return $this->error(); goto X2Oyh; KELCI: GbCCD: goto I8uFb; X2Oyh: goto pkCio; goto KELCI; p0xOm: $name = $request_data["\156\x61\x6d\145"]; goto Nqp3_; Nqp3_: $value = $request_data["\x76\x61\154\165\x65"]; goto B8sIV; g1BeU: pkCio: goto bZIhN; I8uFb: return $this->success(); goto g1BeU; B8sIV: if ($this->db->update($this->table, array($name => $value), array("\151\144", "\x49\x4e", $ids))->is()) { goto GbCCD; } goto XdTfN; jNz73: $ids = $request_data["\x69\x64"]; goto p0xOm; bZIhN: } protected function postCount($request_data) { goto Uncje; mQcG7: return $this->db->select($table)->where($where)->count(); goto lAoFJ; Uncje: $table = $request_data["\x74\x61\x62\x6c\x65"] ?: $this->table; goto zjQBw; zjQBw: $where = $request_data["\167\x68\x65\x72\145"] ?: "\x31\x20\75\x20\61"; goto mQcG7; lAoFJ: } protected function postDelete($request_data) { goto pTQB4; RHeN2: $this->db->rollBack(); goto TPfrx; HrLRV: $this->_callback("\143\x61\x6c\x6c\142\x61\143\x6b\x44\x65\x6c\x65\164\145\x41\x66\x74\145\x72", array(&$request_data)); goto KLlMG; iZBD9: foreach ($ids as $id) { goto u9OQV; JNJnX: goto zkOsL; goto njawn; A4XCQ: $error[] = $id; goto JNJnX; rAeje: zkOsL: goto eXtOa; FIqh8: if ($this->db->delete($this->table, array("\151\144", "\x3d", $id))->is()) { goto pfost; } goto A4XCQ; XE7ZA: $this->_trash($item, $request_data); goto j4eb5; njawn: goto o0t_0; goto vOV6j; j4eb5: o0t_0: goto rAeje; u9OQV: $item = $this->db->select($this->table)->where(array("\x69\x64", "\75", $id))->get(); goto FIqh8; vOV6j: pfost: goto XE7ZA; eXtOa: } goto FOKQg; FOKQg: mEKDV: goto xUamv; ikRZ5: sglNW: goto HrLRV; pTQB4: $this->_callback("\x63\141\154\x6c\x62\141\143\x6b\x44\145\154\x65\164\x65\x42\x65\x66\x6f\x72\145", array(&$request_data)); goto n1QGz; OFnm0: goto q_q8l; goto ikRZ5; n1QGz: $error = array(); goto fBOy2; xUamv: if (count($error) === 0) { goto sglNW; } goto RHeN2; lZkxZ: q_q8l: goto bBeT4; CMoj7: return $this->success(); goto lZkxZ; TPfrx: return $this->error("\346\x9c\211\40" . count($error) . "\xe6\235\241\346\225\260\346\215\256\345\x88\240\xe9\x99\244\xe5\244\xb1\xe8\xb4\245\xef\xbc\x81"); goto OFnm0; KLlMG: $this->db->commit(); goto MF8E6; fBOy2: $ids = $request_data["\151\144"]; goto m3tqA; m3tqA: $this->db->beginTransaction(); goto iZBD9; MF8E6: $this->_log("\162\x65\155\157\166\x65", array("\164\x69\x74\154\x65" => count($ids))); goto CMoj7; bBeT4: } }
